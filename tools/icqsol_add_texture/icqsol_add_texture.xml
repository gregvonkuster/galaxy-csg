<?xml version='1.0' encoding='UTF-8'?>
<tool id="icqsol_add_texture" name="Add texture" version="@WRAPPER_VERSION@.0">
    <description></description>
    <macros>
        <import>icqsol_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command>
<![CDATA[
    python $__tool_directory__/icqsol_add_texture.py
    --input "$input"
    --input_file_format_and_type $input.ext
    --input_dataset_type $input.metadata.dataset_type
    --max_edge_length $max_edge_length
    --texture "$texture"
    --output "$output"
    --output_vtk_type $output_vtk_type
]]>
    </command>
    <inputs>
        <param name="input" type="data" format="plyascii,plybinary,vtkascii,vtkbinary" label="Shape">
            <validator type="dataset_ok_validator" />
        </param>
        <param name="max_edge_length" type="float" value="0" label="Maximum edge length" help="Floating point number.">
            <validator type="in_range" min="0" exclude_min="true" />
        </param>
        <param name="texture" type="select" label="Textures">
            <option value="stone" selected="True">Stone</option>
            <option value="wood">Wood</option>
            <option value="checkboard">Checkerboard</option>
        </param>
        <expand macro="output_vtk_type_params" />
    </inputs>
    <outputs>
        <data name="output" format="vtkascii" label="${tool.name} ${on_string} Max edge length: ${max_edge_length}">
            <actions>
                <action type="format">
                    <option type="from_param" name="output_vtk_type" />
                </action>
            </actions>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="input" value="box_with_surface_field.vtkascii" ftype="vtkascii" />
            <param name="input_file_format_and_type" value="vtkascii" />
            <param name="input_dataset_type" value="POLYDATA" />
            <param name="max_edge_length" value="0.1" />
            <output name="output" file="box_refined.vtkascii" ftype="vtkascii" />
            <param name="output_vtk_type" value="vtkascii" />
        </test>
    </tests>
    <help>
**What it does**

Adds a texture, mapping a png or jpeg picture onto the shape. The shape is projected onto bounding box and the color is selected by flattening the box to fit the image. User can refine the shape for smoother result if desired. 

* **Shape** - Shape to be refined.
* **Maximum edge length** - Points are added to the shape's edges that are longer than the defined maximum length.
* **Texture** - Selection of texture material (currently stone, wood, or checkerboard).

    </help>
    <expand macro="citations" />
</tool>
